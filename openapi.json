{
  "openapi": "3.0.0",
  "info": {
    "title": "Echo Brain API",
    "version": "2.0.0",
    "description": "Complete API documentation for Echo Brain - AI-powered cognitive system"
  },
  "servers": [
    {
      "url": "http://localhost:8309",
      "description": "Echo Brain Main Server"
    },
    {
      "url": "http://localhost:8312",
      "description": "Echo Brain MCP Server"
    }
  ],
  "paths": {
    "/": {
      "get": {
        "summary": "Root health check",
        "tags": ["Core"],
        "responses": {
          "200": {
            "description": "Service is healthy",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          }
        }
      }
    },
    "/health": {
      "get": {
        "summary": "Health check",
        "tags": ["Core"],
        "responses": {
          "200": {
            "description": "Service is healthy"
          }
        }
      }
    },
    "/ready": {
      "get": {
        "summary": "Readiness probe",
        "tags": ["Core"],
        "responses": {
          "200": {
            "description": "Service is ready"
          }
        }
      }
    },
    "/alive": {
      "get": {
        "summary": "Liveness probe",
        "tags": ["Core"],
        "responses": {
          "200": {
            "description": "Service is alive"
          }
        }
      }
    },
    "/metrics": {
      "get": {
        "summary": "Prometheus metrics",
        "tags": ["Core"],
        "responses": {
          "200": {
            "description": "Metrics in Prometheus format"
          }
        }
      }
    },
    "/api/status": {
      "get": {
        "summary": "API status",
        "tags": ["API"],
        "responses": {
          "200": {
            "description": "API status information"
          }
        }
      }
    },
    "/api/echo/query": {
      "post": {
        "summary": "Query Echo Brain",
        "tags": ["Echo"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/QueryRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Query response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QueryResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/echo/chat": {
      "post": {
        "summary": "Chat with Echo Brain",
        "tags": ["Echo"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChatRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Chat response"
          }
        }
      }
    },
    "/api/echo/brain": {
      "get": {
        "summary": "Get brain status",
        "tags": ["Echo"],
        "responses": {
          "200": {
            "description": "Brain status information"
          }
        }
      }
    },
    "/api/echo/thoughts/recent": {
      "get": {
        "summary": "Get recent thoughts",
        "tags": ["Echo"],
        "responses": {
          "200": {
            "description": "Recent thoughts"
          }
        }
      }
    },
    "/api/echo/thoughts/{thought_id}": {
      "get": {
        "summary": "Get specific thought",
        "tags": ["Echo"],
        "parameters": [
          {
            "name": "thought_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Thought details"
          }
        }
      }
    },
    "/api/echo/conversation/{conversation_id}": {
      "get": {
        "summary": "Get conversation",
        "tags": ["Echo"],
        "parameters": [
          {
            "name": "conversation_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Conversation history"
          }
        }
      }
    },
    "/api/echo/conversations": {
      "get": {
        "summary": "List all conversations",
        "tags": ["Echo"],
        "responses": {
          "200": {
            "description": "List of conversations"
          }
        }
      }
    },
    "/api/echo/agents/status": {
      "get": {
        "summary": "Get agent system status",
        "tags": ["Agents"],
        "responses": {
          "200": {
            "description": "Status of all agents"
          }
        }
      }
    },
    "/api/echo/agents/coding": {
      "post": {
        "summary": "Execute coding task",
        "tags": ["Agents"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CodingTaskRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Coding task result"
          }
        }
      }
    },
    "/api/echo/agents/coding/history": {
      "get": {
        "summary": "Get coding agent history",
        "tags": ["Agents"],
        "responses": {
          "200": {
            "description": "Coding agent task history"
          }
        }
      }
    },
    "/api/echo/agents/reasoning": {
      "post": {
        "summary": "Execute reasoning task",
        "tags": ["Agents"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReasoningTaskRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Reasoning task result"
          }
        }
      }
    },
    "/api/echo/agents/reasoning/history": {
      "get": {
        "summary": "Get reasoning agent history",
        "tags": ["Agents"],
        "responses": {
          "200": {
            "description": "Reasoning agent task history"
          }
        }
      }
    },
    "/api/echo/agents/narration": {
      "post": {
        "summary": "Execute narration task",
        "tags": ["Agents"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NarrationTaskRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Narration task result"
          }
        }
      }
    },
    "/api/echo/agents/narration/history": {
      "get": {
        "summary": "Get narration agent history",
        "tags": ["Agents"],
        "responses": {
          "200": {
            "description": "Narration agent task history"
          }
        }
      }
    },
    "/api/models/list": {
      "get": {
        "summary": "List all models",
        "tags": ["Models"],
        "responses": {
          "200": {
            "description": "List of available models",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ModelListResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/models/manifests": {
      "get": {
        "summary": "Get model manifests",
        "tags": ["Models"],
        "responses": {
          "200": {
            "description": "Model manifests and metadata"
          }
        }
      }
    },
    "/api/echo/models/list": {
      "get": {
        "summary": "List Echo models",
        "tags": ["Models"],
        "responses": {
          "200": {
            "description": "List of Echo Brain models"
          }
        }
      }
    },
    "/api/echo/models/pull/{model_name}": {
      "post": {
        "summary": "Pull a model",
        "tags": ["Models"],
        "parameters": [
          {
            "name": "model_name",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Model pull initiated"
          }
        }
      }
    },
    "/api/echo/models/{model_name}": {
      "delete": {
        "summary": "Delete a model",
        "tags": ["Models"],
        "parameters": [
          {
            "name": "model_name",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Model deleted"
          }
        }
      }
    },
    "/api/autonomous/status": {
      "get": {
        "summary": "Autonomous system status",
        "tags": ["Autonomous"],
        "responses": {
          "200": {
            "description": "Autonomous system status"
          }
        }
      }
    },
    "/api/autonomous/goals": {
      "get": {
        "summary": "List goals",
        "tags": ["Autonomous"],
        "responses": {
          "200": {
            "description": "List of autonomous goals"
          }
        }
      },
      "post": {
        "summary": "Create goal",
        "tags": ["Autonomous"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GoalRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Goal created"
          }
        }
      }
    },
    "/api/autonomous/tasks": {
      "get": {
        "summary": "List tasks",
        "tags": ["Autonomous"],
        "responses": {
          "200": {
            "description": "List of autonomous tasks"
          }
        }
      }
    },
    "/api/autonomous/approvals": {
      "get": {
        "summary": "List pending approvals",
        "tags": ["Autonomous"],
        "responses": {
          "200": {
            "description": "List of pending approvals"
          }
        }
      }
    },
    "/api/autonomous/start": {
      "post": {
        "summary": "Start autonomous system",
        "tags": ["Autonomous"],
        "responses": {
          "200": {
            "description": "System started"
          }
        }
      }
    },
    "/api/autonomous/stop": {
      "post": {
        "summary": "Stop autonomous system",
        "tags": ["Autonomous"],
        "responses": {
          "200": {
            "description": "System stopped"
          }
        }
      }
    },
    "/api/autonomous/pause": {
      "post": {
        "summary": "Pause autonomous system",
        "tags": ["Autonomous"],
        "responses": {
          "200": {
            "description": "System paused"
          }
        }
      }
    },
    "/api/autonomous/resume": {
      "post": {
        "summary": "Resume autonomous system",
        "tags": ["Autonomous"],
        "responses": {
          "200": {
            "description": "System resumed"
          }
        }
      }
    },
    "/api/autonomous/cycle": {
      "post": {
        "summary": "Run one autonomous cycle",
        "tags": ["Autonomous"],
        "responses": {
          "200": {
            "description": "Cycle completed"
          }
        }
      }
    },
    "/api/echo/codebase/search": {
      "get": {
        "summary": "Search codebase",
        "tags": ["Codebase"],
        "parameters": [
          {
            "name": "q",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Search results"
          },
          "500": {
            "description": "Database error - needs fixing"
          }
        }
      }
    },
    "/api/echo/codebase/stats": {
      "get": {
        "summary": "Get codebase statistics",
        "tags": ["Codebase"],
        "responses": {
          "200": {
            "description": "Codebase statistics"
          }
        }
      }
    },
    "/api/echo/codebase/reindex": {
      "post": {
        "summary": "Reindex codebase",
        "tags": ["Codebase"],
        "responses": {
          "200": {
            "description": "Reindexing started"
          }
        }
      }
    },
    "/api/diagnostics/health": {
      "get": {
        "summary": "Diagnostics health check",
        "tags": ["Diagnostics"],
        "responses": {
          "200": {
            "description": "System diagnostics"
          }
        }
      }
    },
    "/api/diagnostics/full": {
      "get": {
        "summary": "Full system diagnostics",
        "tags": ["Diagnostics"],
        "responses": {
          "200": {
            "description": "Complete diagnostics report"
          }
        }
      }
    },
    "/api/diagnostics/telegram": {
      "get": {
        "summary": "Telegram bot diagnostics",
        "tags": ["Diagnostics"],
        "responses": {
          "200": {
            "description": "Telegram bot status"
          }
        }
      }
    },
    "/api/echo/anime/scene/plan": {
      "post": {
        "summary": "Plan anime scene",
        "tags": ["Anime"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ScenePlanRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Scene plan generated"
          }
        }
      }
    },
    "/api/echo/anime/prompt/refine": {
      "post": {
        "summary": "Refine anime prompt",
        "tags": ["Anime"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PromptRefineRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Refined prompt"
          }
        }
      }
    },
    "/api/echo/anime/feedback/learn": {
      "post": {
        "summary": "Learn from feedback",
        "tags": ["Anime"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/FeedbackLearnRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Feedback processed"
          }
        }
      }
    },
    "/api/context": {
      "post": {
        "summary": "Get context",
        "tags": ["Context"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ContextRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Context results"
          },
          "500": {
            "description": "Database error - needs fixing"
          }
        }
      }
    },
    "/api/context/unified": {
      "post": {
        "summary": "Get unified context",
        "tags": ["Context"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ContextRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Unified context results"
          }
        }
      }
    },
    "/api/collections": {
      "get": {
        "summary": "List collections",
        "tags": ["Context"],
        "responses": {
          "200": {
            "description": "List of vector collections"
          }
        }
      }
    },
    "/api/coordination/services": {
      "get": {
        "summary": "List coordinated services",
        "tags": ["Coordination"],
        "responses": {
          "200": {
            "description": "Service coordination status"
          }
        }
      }
    },
    "/api/theater/agents": {
      "get": {
        "summary": "List theater agents",
        "tags": ["Theater"],
        "responses": {
          "200": {
            "description": "Theater agent status"
          }
        }
      }
    },
    "/git/status": {
      "get": {
        "summary": "Git status",
        "tags": ["Git"],
        "responses": {
          "200": {
            "description": "Git repository status"
          }
        }
      }
    },
    "/git/commit": {
      "post": {
        "summary": "Create git commit",
        "tags": ["Git"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GitCommitRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Commit created"
          },
          "500": {
            "description": "Git error - needs fixing"
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "HealthResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string"
          },
          "uptime_seconds": {
            "type": "integer"
          },
          "version": {
            "type": "string"
          }
        }
      },
      "QueryRequest": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string"
          },
          "conversation_id": {
            "type": "string"
          },
          "mode": {
            "type": "string",
            "enum": ["default", "code_only", "creative"]
          }
        },
        "required": ["query"]
      },
      "QueryResponse": {
        "type": "object",
        "properties": {
          "response": {
            "type": "string"
          },
          "conversation_id": {
            "type": "string"
          },
          "timestamp": {
            "type": "string"
          }
        }
      },
      "ChatRequest": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string"
          },
          "conversation_id": {
            "type": "string"
          }
        },
        "required": ["query"]
      },
      "CodingTaskRequest": {
        "type": "object",
        "properties": {
          "task": {
            "type": "string"
          },
          "context": {
            "type": "string"
          }
        },
        "required": ["task"]
      },
      "ReasoningTaskRequest": {
        "type": "object",
        "properties": {
          "task": {
            "type": "string"
          },
          "context": {
            "type": "string"
          }
        },
        "required": ["task"]
      },
      "NarrationTaskRequest": {
        "type": "object",
        "properties": {
          "task": {
            "type": "string"
          }
        },
        "required": ["task"]
      },
      "ModelListResponse": {
        "type": "object",
        "properties": {
          "models": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ModelInfo"
            }
          },
          "total": {
            "type": "integer"
          }
        }
      },
      "ModelInfo": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "size": {
            "type": "string"
          },
          "modified": {
            "type": "string"
          }
        }
      },
      "GoalRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          }
        },
        "required": ["name"]
      },
      "ScenePlanRequest": {
        "type": "object",
        "properties": {
          "session_id": {
            "type": "string"
          },
          "scene_description": {
            "type": "string"
          }
        },
        "required": ["session_id", "scene_description"]
      },
      "PromptRefineRequest": {
        "type": "object",
        "properties": {
          "session_id": {
            "type": "string"
          },
          "raw_prompt": {
            "type": "string"
          }
        },
        "required": ["session_id", "raw_prompt"]
      },
      "FeedbackLearnRequest": {
        "type": "object",
        "properties": {
          "session_id": {
            "type": "string"
          },
          "prompt_used": {
            "type": "string"
          },
          "quality_scores": {
            "type": "object"
          },
          "generation_id": {
            "type": "string"
          }
        },
        "required": ["session_id", "prompt_used", "quality_scores", "generation_id"]
      },
      "ContextRequest": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string"
          },
          "limit": {
            "type": "integer",
            "default": 5
          }
        },
        "required": ["query"]
      },
      "GitCommitRequest": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string"
          }
        },
        "required": ["message"]
      }
    }
  },
  "tags": [
    {"name": "Core", "description": "Core health and status endpoints"},
    {"name": "API", "description": "General API endpoints"},
    {"name": "Echo", "description": "Echo Brain main functionality"},
    {"name": "Agents", "description": "Agent system endpoints"},
    {"name": "Models", "description": "Model management"},
    {"name": "Autonomous", "description": "Autonomous system control"},
    {"name": "Codebase", "description": "Codebase operations"},
    {"name": "Diagnostics", "description": "System diagnostics"},
    {"name": "Anime", "description": "Anime generation module"},
    {"name": "Context", "description": "Context and memory"},
    {"name": "Coordination", "description": "Service coordination"},
    {"name": "Theater", "description": "Agent theater"},
    {"name": "Git", "description": "Git operations"}
  ]
}