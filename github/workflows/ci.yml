yaml<br>name: Echo Brain CI<br><br>on:<br> push:<br> branches: [ main, develop ]<br> pull_request:<br> branches: [ main ]<br><br>jobs:<br> test:<br> runs-on: ubuntu-latest<br> <br> # Start services needed for tests (Postgres, Redis)<br> services:<br> postgres:<br> image: postgres:15<br> env:<br> POSTGRES_PASSWORD: testpassword<br> options: >-<br> --health-cmd pg_isready<br> --health-interval 10s<br> --health-timeout 5s<br> --health-retries 5<br> ports:<br> - 5432:5432<br> <br> redis:<br> image: redis:7<br> options: >-<br> --health-cmd "redis-cli ping"<br> --health-interval 10s<br> --health-timeout 5s<br> --health-retries 5<br> ports:<br> - 6379:6379<br><br> steps:<br> - uses: actions/checkout@v4<br> <br> - name: Set up Python<br> uses: actions/setup-python@v4<br> with:<br> python-version: '3.11'<br> <br> - name: Install dependencies<br> run: |<br> python -m pip install --upgrade pip<br> pip install -r requirements.txt<br> pip install pytest pytest-cov<br> <br> - name: Run unit tests<br> run: |<br> pytest tests/ -v --cov=./ --cov-report=xml<br>
